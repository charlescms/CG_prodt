<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML><!-- #BeginTemplate "/Templates/program2.dwt" --><!-- DW6 --><HEAD>
<META NAME="Author" CONTENT="AriaFan"><!-- #BeginEditable "doctitle" --> 
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
<TITLE>Библиотека функций rFunc - История изменений</TITLE>
<!-- #EndEditable -->
<LINK REL="SHORTCUT ICON" HREF="../favicon.ico">
<LINK REL="stylesheet" HREF="../polesoft.css">
</HEAD>
<BODY LINK="#339966" VLINK="#3300FF" TEXT="#003333">
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=2 WIDTH="100%"><TR>
      <TD WIDTH="6%" CLASS="pghdr2"><A HREF="index.html" TARGET="_parent"><IMG HEIGHT=34 WIDTH=34 SRC="../img/home.gif" ALIGN="TOP" BORDER=0 ALT="Main"></A></TD>
      <TD WIDTH="94%" CLASS="pghdr2"><!-- #BeginEditable "Header" -->Библиотека функций <SPAN CLASS="txblue">rFunc</SPAN><BR>
      История изменений<!-- #EndEditable --> 
      </TD>
    </TR>
</TABLE>
<BR><!-- #BeginEditable "Body" -->
<DIV CLASS="txfix">Условные обозначения:<br>
  + добавлено<br>
  - удалено<br>
  # изменено<br>
  * исправлены ошибки<br>
  ====================================================================<br>
  Версия 2.1.3.1 RC 25.11.2003<br>
  --------------<br>
1.# Теперь память для результирующей строки выделяется ровно столько, сколько нужно.<br>
2.* Исправлена WordCount, теперь верно возвращает количество слов при<br>
третьем параметре равным единице.<br>
3.* Исправлена StrStuff LongStrStuff, не удалялся последний символ из<br>
входной строки.<br>
4.+ Функция b_TextPos - аналог b_StrPos, только поиск регистронезависимый.<br>
5.+ Функция fRemove - удаление файла.<br>
6.+ Тригонометрические функции - acos, asin, atan, atan2, cos, cosh,<br>
sin, sinh, tan, tanh, а также sqrt, exp, log, ln, log10.<br>
7.* Исправлена ExprIsValid. Наблюдалась потеря коннекта, если проверялось выражение<br>
с неверным параметром.<br>
8.# Добавлен параметр mode в функции fopen для маски при создании файла.<br>
9.+ Константы для работы с файлами:<br>
fo_append - запись в конец файла для функции fopen.<br>
fs_iread, fs_iwrite, fs_iexec - биты доступа на чтение/запись/выполнение владельца файла<br>
при создании. (Функции fcreate, fopen с режимом FO_CREAT.)<br>
10.+ Математические константы: e, pi.<br>
11.+ Функция ExtractMillisecond для версии IB6 и выше.<br>
12.+ Функция md5sum - высчитывает контрольную сумму входной строки по алгоритму MD5.<br>
13.+ Функции md5Init, md5Update, md5Final для поблочного вычисления md5 контрольной суммы.<br>
14.* Изменен тип второго параметра в функции NumInWords на строковый (грамматический род).<br>
Допустимые значения: N - Средний, M - Мужской, F - Женский, P - Множественное.<br>
15.+ Добавлена функция CreateGUID. Формат результата зависит от параметра<br>
компиляции RGUID_WIN_STYLE. По-умолчанию используется формат linux.<br>
16.* Изменен формат файлов сборки. Теперь все настройки вынесены в<br>
rfunc.conf. Внимание! Действуют настройки по-умолчанию!<br>
17.+ Функция fSize - размер файла.<br>
.<br>
<a name="beta"></a>Версия 2.1.2.4 Beta2 20.10.2003<br>
--------------<br>
1.+ Функция b_StrCmp - сравнение двух строковых BLOB.<br>
Возвращает:<br>
-1 - первый меньше,<br>
0 - равны,<br>
1 - первый больше.<br>
2.+ Функция b_StrPos - поиск подстроки в BLOB.<br>
BLOB читается сегментами размера b-&gt;blob_max_segment + strlen(s) + 1L<br>
в процессе поиска.<br>
3.+ Функции DoubleToDate и DoubleToTime - преобразование числа в дату и время.<br>
4.+ Файловые функции: fcreate, fopen, fread, fwrite, fseek, fclose.<br>
5.+ Функции-константы для режимов открытия файлов:<br>
fseek_cur, fseek_end, fseek_set<br>
fo_rdonly, fo_wronly, fo_rdwr<br>
fo_creat, fo_trunc, fo_excl<br>
.<br>
Версия 2.1.1.1 Beta 11.06.2003<br>
--------------<br>
1.# Переписана IncDate. Теперь она работает так:<br>
- сначала изменяется год, затем месяц, затем день;<br>
- если изначальная дата была последним днем месяца, то после изменения года и месяца<br>
она вновь делается послежним днем месяца, а уж потом прибавляются дни;<br>
- если после изменения года и месяца день больше, чем максимальное число дней в месяце,<br>
то день устанавливается последним днем месяца.<br>
2.+ Функция StrCmp(str1, str2) - сравнение двух строк.<br>
3.+ Функции C, LongC - выдает пустую строку, если значение поля Null, либо саму строку, если она не Null.<br>
4.+ Функции MaxDate и MinDate - большая и меньшая даты соответственно.<br>
5.+ Теперь можно скомпилировать функции дат для IB6, указав -DCOMPILE_DATETIME в make-файле.<br>
6.+ Функции iEqual(i1, i2), dtEqual(dt1, dt2), /*??? dEqual(d1, d2), пока закомментанрил для вещественных чисел*/<br>
cEqual(str1, str2) - проверка на равенство.<br>
7.+ Функции FloatToStr(d, fmt), IntToStr(d, fmt) - форматирование вещественного и целого числа.<br>
8.# Поддержка украинских букв &quot;іІїЇєЄ&quot; в функциях rUpper, rLower, rTranslit, rLatin.<br>
9.* Исправлены b_SubStr, b_LongSubStr, SubStr, StrRepeat, LongStrRepeat. В некоторых местах<br>
оператор return &quot;&quot;; заменен на более подходящий по смыслу.<br>
10.* Импорт точек входа из gds32 идет по именам, а не по номерам.<br>
11.* Используется ib_util.h из каталога $(IBASE)/include. Исправлен параметр запуска implib для него.<br>
12.* Исправлены ошибки объявления функций Chr, b_SubStr, b_LongSubStr, b_Line, b_LongLine.<br>
добавлен параметр FREE_IT.<br>
13.+ Для всех функций &quot;разбора&quot; дат добавлены декларации функций вида<br>
ExtractXXXX (например, ExtractDay, ExtractMonth). Это то же самое,<br>
что и Day, Month и т.д. Их можно использовать во всех версиях Interbase.<br>
ExtractXXXX - это полные аналоги функции EXTRACT(XXXX FOR date) в диалекте 3.<br>
14.+ Функция IncDateTime, чтобы можно было к дате прибавить ещё и время, кроме собственно даты.<br>
15.+ Функция Sign - знак числа.<br>
16.* Исправлен парсер, не верно работала функция &quot;IF&quot;.<br>
17.+ Функция NumInWords - число прописью в win1251.<br>
18.+ Функции RepeatTrim и LongRepeatTrim - удаляют в слове дублирование переданного символа.<br>
19.+ Функции ConvertSymbols и LongConvertSymbols - Замена символов в строке из одного набора на символы из другого.<br>
20.# b_Line, b_LongLine теперь не выводит в строке символы с кодом 0x0D и 0x0A.<br>
21.* Исправлена CalcExpr, была ошибка при передаче параметров.<br>
22.+ make файлы для Solaris и FreeBSD.<br>
23.* Исправлены все функции, возвращающие дату. Где это возможно - задействуется входной параметр, где нет - добавлено FREE_IT в объявление функции.<br>
24.+ Функции TimeToDouble и DateToDouble - преобразование времени (даты) в вещественное число.<br>
25.# Изменены make-файлы, чтобы можно было собрать с библиотекой fbclient.<br>
26.+ Функция EAN13cs - подсчет 13-й цифры кода EAN13.<br>
.<br>
<a name="stable"></a>Версия 2.0.1.2 20.07.2001<br>
--------------<br>
1.+ Функция IncDate(date, dd, mm, yy) - изменение даты на заданное количество<br>
дней, месяцев, лет. Допустимы любые сочетания, инкремент и декремент, например,<br>
SELECT IncDate('11.07.2001', -17, 14, -2), IncDate('11.07.2001', 0, 12, 0)<br>
FROM RDB$DATABASE<br>
2.* Функция Quarter.<br>
.<br>
Версия 2.0.0.2 31.05.2001<br>
--------------<br>
1.+ Работа с blob-полями.<br>
b_Number_Segments - количество сегментов,<br>
b_Max_Segment - максимальная длина сегмента,<br>
b_Total_Length - количество байтов,<br>
b_Line_Count - количество строк (!!! не зависит от того,<br>
есть ли последний перевод строки !!!),<br>
b_SubStr, b_LongSubStr - аналогичны строковым, только работают с blob-полями,<br>
b_Line, b_LongLine - выдает строку из blob-поля по номеру,<br>
b_Put_Segment - запись сегмента в blob-поле (пример смотри в rtest.sql),<br>
2.# Расширение использования Функции SubStr:<br>
m &lt; 0 - отсчет происходит с конца строки,<br>
n &lt; 0 - выводятся символы слева от точки отсчета.<br>
Например:<br>
SELECT job_title, SubStr(job_title, -2, -3) FROM job<br>
Manager age<br>
Engineer nee<br>
3.+ Функции генерации псевдослучайного числа:<br>
initRandom - инициализация генератора псевдослучайных чисел,<br>
getRandom - получение слудующего псевдослучайного числа.<br>
(!!! Наличие параметров в обеих вызовах функций обусловлено разницей в работе функций<br>
под Win32 и Linux !!!).<br>
4.+ Функции для работы с датами:<br>
YearDay, WeekDay - номер дня в году и в неделе,<br>
Quarter - выдает квартал из даты,<br>
FirstDayMonth, LastDayMonth - первый и последний день месяца датой,<br>
isLeapYear - високосный ли год,<br>
DaysBetween - количество дней между датами,<br>
ExtractTime - оставляет только время без даты.<br>
5.# Замена malloc на ib_util_malloc для IB5.x и выше.<br>
6.+ Функции работы с битовыми полями:<br>
getBit, setBit,<br>
bitAnd, bitOr, bitXor, bitNot.<br>
7.# Все функции разнесены по модулям:<br>
rblob - работа с blob-полями,<br>
rcalc - парсер,<br>
rdatetime - работа с датами,<br>
rmath - математические,<br>
rmisc - разное,<br>
rsecurity - системные,<br>
rstring - строковые.<br>
8.# CSTRING(255) заменено в объявлениях на CSTRING(256), CSTRING(16383) на CSTRING(16384)<br>
9.+ Поддержка IB 6.0, Firebird 0.9<br>
10.+ Функция dtIf - аналог iIf, только работает с датами.<br>
11.+ Функции<br>
PadRight, PadLeft, LongPadRight, LongPadLeft - дополнение строки до заданной ширины<br>
указанным символом.<br>
rTranslit, LongrTranslit - транслитерация из win1251 в латиницу.<br>
rLatin, LongrLatin - замена символов из win1251 на &quot;похожие&quot; из латиницы.<br>
12.# Изменены rUpper, rLower для ускорения работы;<br>
StrCount - были перепутаны местами входные параметры.<br>
13.+ rtest.sql - скрипт для тестирования и демонстрации работы библиотеки.<br>
.<br>
Версия 1.5.2 10.03.2000<br>
------------<br>
1.+ Поддержка Linux.<br>
2.# Все объявления int в функциях заменены на Long.<br>
3.+ Функции<br>
EncodeDateTime - собирает дату со временем;<br>
Hour, Minute, Second - вывод часов, минут, секунд из даты<br>
.<br>
Версия 1.5.1 17.02.2000<br>
------------<br>
1.* SubStr - нельзя было вырезать последний символ из строки.<br>
.<br>
Версия 1.5.0 20.01.2000<br>
------------<br>
1.+ Функции<br>
SoftRound - округление с заданной точночтью, только если результат<br>
округления - не ноль;<br>
Div - целая часть от деления;<br>
Mod - остаток от деления;<br>
LongRUpper, LongRLower - перевод регистра для кодировки WIN1251 длинных<br>
строк.<br>
.<br>
Версия 1.4.0 27.11.99<br>
------------<br>
1.+ Функции rUpper, rLower<br>
2.# Изменены типы параметра flag на SMALLINT для<br>
WordNum, LongWordNum, WordCount<br>
.<br>
Версия 1.3.2 17.11.99<br>
------------<br>
1.* Исправлены ltrim, rtrim, trim<br>
.<br>
Версия 1.3.1 16.11.99<br>
------------<br>
1.* Исправлена функция SubStr<br>
2.# Для работы с функциями add_user, modify_user, delete_user<br>
под IB 4.2 необходимо иметь клиента поновее :)<br>
Будьте внимательны с паролем, он должен быть не более 8 символов.<br>
.<br>
Версия 1.3.0 12.11.99<br>
------------<br>
1.+ Функции:<br>
Z - обнуление пустого значения<br>
dif, iif, cif - реализация iif с разными типами параметров<br>
DZero - деление со значением по-умолчанию<br>
StrCount - количество вхождений подстроки в строку<br>
WordCount(s, delims, flag) - Количество слов в строке<br>
s - строка<br>
delims - разделители<br>
flag - считать ли несколько разделителей вместе пустой строкой<br>
WordNum - N-е слово в строке<br>
Просто вызов API функций. Требует передачи имени и пароля администратора.<br>
add_user - добавление пользователя<br>
modify_user - изменение параметров пользователя<br>
delete_user - удаление пользователя<br>
MsgBox(lpText, lpCaption, Flags) - Выводит окно сообщения с<br>
возможностью выбора. НЕ РЕКОМЕНДУЕТСЯ ИСПОЛЬЗОВАНИЕ на сервере :)<br>
CalcExpr(s, inVar) - Простенький анализатор выражений.<br>
+ - * /<br>
Стандартный набор математических функций:<br>
Sin, Cos, tg, ctg, AcrCos, ArcSin, ArcTg, sh, ch, th,<br>
exp, lh, lg, sqrt, sqr, abs<br>
Sgn - знак числа<br>
Log - логарифм по произвольному основанию<br>
Power - возведение в степень<br>
If(expr, x1, x2)<br>
Min(x1, ...) - с неограниченным количеством параметров<br>
Max(x1, ...)<br>
Sum(x1, ...) - Суммирование аргументов<br>
Avg(x1, ...) - Среднее арифметическое<br>
Pi - предопределенная переменная.<br>
Для использования переменных в выражении - перед ними ставится двоеточие,<br>
и они описываются во второй строке (см. пример).<br>
ExprIsVal(s, inVar) - Проверка на корректность заданного выражения.<br>
Пример использования:<br>
CalcExpr('Sin( Pi*:p11/3)*:P2', 'P11=2;P2=10')<br>
.<br>
Версия 1.2.3 26.03.99<br>
------------<br>
1.+ Функция ExtractDate.<br>
.<br>
Версия 1.2.2 22.03.99<br>
------------<br>
1.* Исправлен глючок в Round.<br>
.<br>
Версия 1.2.1 18.02.99<br>
------------<br>
1.# В вызовах функций работы с длинными строками тип строк изменен на<br>
CSTRING(16383).<br>
2.* Исправлены функции LongStrStuff, LongStrReplace.<br>
3.+ Функции StrReplace и LongStrRepeat.<br>
4.# Изменены параметры функций:<br>
StrLen, StrPos - c CSTRING(255) на CSTRING(16383)<br>
SubStr - c SMALLINT на INTEGER.<br>
5.+ &quot;Псевдофункции&quot; LongLTrim, LongRTrim, LongTrim, LongSubStr.<br>
6.* Исправлен rfunc.bor.<br>
.<br>
Версия 1.2.0 10.02.99<br>
------------<br>
1.+ Функции LongStrStuff, LongStrReplace.<br>
.<br>
Версия 1.1 05.10.98<br>
----------<br>
1.* Исправлена StrStuff.<br>
2.+ Функции Ord, Chr, Round.<br>
.<br>
Версия 1.0<br>
----------<br>
1.* Исправлена для использования в IB 5.x.<br>
.<br>
Версия 0.5<br>
----------<br>
Явилась на свет.</DIV>
<!-- #EndEditable --> 
<P CLASS="cprght"><img src="../img/pixelgr.gif" width="100%" height="1"><br>
  Copyright &copy; 2003 Polaris Software
</p></BODY><!-- #EndTemplate --></HTML>
 