SELECT
         *
/*  CONTRATOTRANSPORTE2.NOMEMIX                                                                                                 as NOMEMIX ,
  CONTRATOTRANSPORTE2.QUANT_PREVISTA                                                                                          as QUANT_PREVISTA ,
  CONTRATOTRANSPORTE2.VALOR_PREVISTO                                                                                          as VALOR_PREVISTO ,
  IIF( Sum(CONTRATOTRANSPORTE2.QUANTIDADETOTAL)             IS NULL ,0, Sum(CONTRATOTRANSPORTE2.QUANTIDADETOTAL)            ) AS QuantidadeTotal,
  iIF( Sum(CONTRATOTRANSPORTE2.VALORSCCTOTAL)               IS NULL ,0, Sum(CONTRATOTRANSPORTE2.VALORSCCTOTAL)              ) AS VALORSCCTOTAL ,
  IIF( Sum(CONTRATOTRANSPORTE2.QUANTTOTALEXP)               IS NULL ,0, Sum(CONTRATOTRANSPORTE2.QUANTTOTALEXP)              ) AS QUANTTOTALEXP,
  IIF( Sum(CONTRATOTRANSPORTE2.VALORTOTALEXP)               IS NULL ,0, Sum(CONTRATOTRANSPORTE2.VALORTOTALEXP)              ) AS VALORTOTALEXP,
  IIF( Sum(CONTRATOTRANSPORTE2.QUANTADEPENDENTE)            IS NULL ,0, Sum(CONTRATOTRANSPORTE2.QUANTADEPENDENTE)           ) AS QUANTADEPENDENTE,
  IIF( Sum(CONTRATOTRANSPORTE2.VALORTOTALPENDENTE)          IS NULL ,0, Sum(CONTRATOTRANSPORTE2.VALORTOTALPENDENTE)         ) AS VALORTOTALPENDENTE,
  IIF( Sum(CONTRATOTRANSPORTE2.ValorTotalComissaoExecutado) IS NULL ,0, Sum(CONTRATOTRANSPORTE2.ValorTotalComissaoExecutado)) AS ValorTotalComissaoExecutado ,
  IIF( Sum(CONTRATOTRANSPORTE2.VlTotalComissaoPendente)     IS NULL ,0, Sum(CONTRATOTRANSPORTE2.VlTotalComissaoPendente)    ) AS VlTotalComissaoPendente ,
  IIF( Sum(CONTRATOTRANSPORTE2.VALORTOTALCOMISSAO)          IS NULL ,0, Sum(CONTRATOTRANSPORTE2.VALORTOTALCOMISSAO)         ) AS VALORTOTALCOMISSAO
  */
FROM
(
SELECT
  CONTRATOTRANSPORTE.NOMEMIX                            as NOMEMIX ,
  PRODUTOs.QUANT_PREVISTA                               as QUANT_PREVISTA ,
  PRODUTOs.VALOR_PREVISTO                               as VALOR_PREVISTO ,
  /* IIF( (CONTRATOTRANSPORTE.QUANTIDADETOTAL) 	        IS NULL ,0, (CONTRATOTRANSPORTE.QUANTIDADETOTAL) 	         ) AS QuantidadeTotal, */
  (select iif(sum( ProdutoContratoT.Quantidade)IS NULL ,0,sum( ProdutoContratoT.Quantidade) )  from ProdutoContratoT where  CONTRATOTRANSPORTE.Contrato =  ProdutoContratoT.Contrato )   QuantidadeTotal,
  /* iIF( (CONTRATOTRANSPORTE.VALORSCCTOTAL)   	        IS NULL ,0, (CONTRATOTRANSPORTE.VALORSCCTOTAL)   	         )  AS VALORSCCTOTAL , */
  (select iif(sum( ProdutoContratoT.ValorSCC)IS NULL ,0,sum( ProdutoContratoT.ValorSCC) )  from ProdutoContratoT where  CONTRATOTRANSPORTE.Contrato =  ProdutoContratoT.Contrato )   VALORSCCTOTAL_pro,
  /* IIF( (CONTRATOTRANSPORTE.QUANTTOTALEXP )   	        IS NULL ,0, (CONTRATOTRANSPORTE.QUANTTOTALEXP)   	         )  AS QUANTTOTALEXP, */
  (select iif(sum( ExportadoTransito.QuantidadeExp)IS NULL ,0,sum( ExportadoTransito.QuantidadeExp) )  from ExportadoTransito where  CONTRATOTRANSPORTE.Contrato =  ExportadoTransito.Contrato )   QUANTTOTALEXP_pro,
  /* IIF( (CONTRATOTRANSPORTE.VALORTOTALEXP)   	        IS NULL ,0, (CONTRATOTRANSPORTE.VALORTOTALEXP)   	         )  AS VALORTOTALEXP, */
  (select iif(sum( ExportadoTransito.VALOR) IS NULL ,0,sum( ExportadoTransito.VALOR) )  from ExportadoTransito where  CONTRATOTRANSPORTE.Contrato =  ExportadoTransito.Contrato )   VALORTOTALEXP_pro,
  IIF( (CONTRATOTRANSPORTE.QUANTADEPENDENTE)            IS NULL ,0, (CONTRATOTRANSPORTE.QUANTADEPENDENTE)           )  AS QUANTADEPENDENTE,
  IIF( (CONTRATOTRANSPORTE.VALORTOTALPENDENTE)          IS NULL ,0, (CONTRATOTRANSPORTE.VALORTOTALPENDENTE)         )  AS VALORTOTALPENDENTE,
  IIF( (CONTRATOTRANSPORTE.ValorTotalComissaoExecutado) IS NULL ,0, (CONTRATOTRANSPORTE.ValorTotalComissaoExecutado))  AS ValorTotalComissaoExecutado ,
  (select iif(sum( ExportadoTransito.ValorConvertido)IS NULL ,0,sum( ExportadoTransito.ValorConvertido) )  from ExportadoTransito where  CONTRATOTRANSPORTE.Contrato =  ExportadoTransito.Contrato )   ValorTotalComissaoExecutado_pro,
  IIF( (CONTRATOTRANSPORTE.VlTotalComissaoPendente)     IS NULL ,0, (CONTRATOTRANSPORTE.VlTotalComissaoPendente)    )  AS VlTotalComissaoPendente ,
  IIF( (CONTRATOTRANSPORTE.VlTotalComissaoPendente)     IS NULL ,0, (CONTRATOTRANSPORTE.VlTotalComissaoPendente)    )  AS VlTotalComissaoPendente_PRO ,
/* VlTotalComissaoPendente := TabGlobal.DContratoTransporte.ValorTotalComissao.Conteudo - TabGlobal.DContratoTransporte.ValorTotalComissaoExecutado.Conteudo ;*/
  (select iif(sum( ProdutoContratoT.ComisaoSFatura)IS NULL ,0,sum( ProdutoContratoT.ComisaoSFatura) )  from ProdutoContratoT where  CONTRATOTRANSPORTE.Contrato =  ProdutoContratoT.Contrato )   VALORTOTALCOMISSAO_pro,
/*  ( VALORTOTALCOMISSAO_pro - ValorTotalComissaoExecutado_pro ) */
  IIF( (CONTRATOTRANSPORTE.VALORTOTALCOMISSAO)          IS NULL ,0, (CONTRATOTRANSPORTE.VALORTOTALCOMISSAO)         )  AS VALORTOTALCOMISSAO
FROM CONTRATOTRANSPORTE ,  PRODUTOS  where CONTRATOTRANSPORTE.NOMEMIX = PRODUTOs.PRODUTO AND  CONTRATOTRANSPORTE.CADASTRO >= '2012/12/01' AND CONTRATOTRANSPORTE.CADASTRO <= '2013/08/15'
/* GROUP BY CONTRATOTRANSPORTE.NOMEMIX     ,PRODUTOs.QUANT_PREVISTA, PRODUTOs.VALOR_PREVISTO
   (select sum( ProdutoContratoT.Quantidade)   from ProdutoContratoT where  CONTRATOTRANSPORTE.Contrato =  ProdutoContratoT.Contrato )   QuantidadeTotal_pro, */

) AS   CONTRATOTRANSPORTE2














SELECT
/* 
  CONTRATOTRANSPORTE.NOMEMIX                              as NOMEMIX ,
  PRODUTOs.QUANT_PREVISTA                                 as QUANT_PREVISTA ,
  PRODUTOs.VALOR_PREVISTO                                 as VALOR_PREVISTO , */
  IIF( Sum(CONTRATOTRANSPORTE.QUANTIDADETOTAL) 	          IS NULL ,0, Sum(CONTRATOTRANSPORTE.QUANTIDADETOTAL) 	         ) AS QuantidadeTotal,
          (select sum( ProdutoContratoT.Quantidade)   from ProdutoContratoT where  CONTRATOTRANSPORTE.Contrato =  ProdutoContratoT.Contrato )   QuantidadeTotal_pro, */
  iIF( Sum(CONTRATOTRANSPORTE.VALORSCCTOTAL)   	          IS NULL ,0, Sum(CONTRATOTRANSPORTE.VALORSCCTOTAL)   	         )  AS VALORSCCTOTAL ,
  IIF( Sum(CONTRATOTRANSPORTE.QUANTTOTALEXP)   	          IS NULL ,0, Sum(CONTRATOTRANSPORTE.QUANTTOTALEXP)   	         )  AS QUANTTOTALEXP,
  IIF( Sum(CONTRATOTRANSPORTE.VALORTOTALEXP)   	          IS NULL ,0, Sum(CONTRATOTRANSPORTE.VALORTOTALEXP)   	         )  AS VALORTOTALEXP,
  IIF( Sum(CONTRATOTRANSPORTE.QUANTADEPENDENTE)            IS NULL ,0, Sum(CONTRATOTRANSPORTE.QUANTADEPENDENTE)           )  AS QUANTADEPENDENTE,
  IIF( Sum(CONTRATOTRANSPORTE.VALORTOTALPENDENTE)          IS NULL ,0, Sum(CONTRATOTRANSPORTE.VALORTOTALPENDENTE)         )  AS VALORTOTALPENDENTE,
  IIF( Sum(CONTRATOTRANSPORTE.ValorTotalComissaoExecutado) IS NULL ,0, Sum(CONTRATOTRANSPORTE.ValorTotalComissaoExecutado))  AS ValorTotalComissaoExecutado ,
  IIF( Sum(CONTRATOTRANSPORTE.VlTotalComissaoPendente)     IS NULL ,0, Sum(CONTRATOTRANSPORTE.VlTotalComissaoPendente)    )  AS VlTotalComissaoPendente ,
  IIF( Sum(CONTRATOTRANSPORTE.VALORTOTALCOMISSAO)          IS NULL ,0, Sum(CONTRATOTRANSPORTE.VALORTOTALCOMISSAO)         )  AS VALORTOTALCOMISSAO
FROM CONTRATOTRANSPORTE ,  PRODUTOS  where CONTRATOTRANSPORTE.NOMEMIX = PRODUTOs.PRODUTO AND  CONTRATOTRANSPORTE.CADASTRO >= '2012/12/01' AND CONTRATOTRANSPORTE.CADASTRO <= '2013/08/15'
/* GROUP BY CONTRATOTRANSPORTE.NOMEMIX     ,PRODUTOs.QUANT_PREVISTA, PRODUTOs.VALOR_PREVISTO */



  CONTRATOTRANSPORTE2.NOMEMIX                                                                                                 as NOMEMIX ,
  CONTRATOTRANSPORTE2.QUANT_PREVISTA                                                                                          as QUANT_PREVISTA ,
  CONTRATOTRANSPORTE2.VALOR_PREVISTO                                                                                          as VALOR_PREVISTO , 
  IIF( Sum(CONTRATOTRANSPORTE2.QUANTIDADETOTAL)             IS NULL ,0, Sum(CONTRATOTRANSPORTE2.QUANTIDADETOTAL)            ) AS QuantidadeTotal,
  iIF( Sum(CONTRATOTRANSPORTE2.VALORSCCTOTAL)               IS NULL ,0, Sum(CONTRATOTRANSPORTE2.VALORSCCTOTAL)              ) AS VALORSCCTOTAL ,
  IIF( Sum(CONTRATOTRANSPORTE2.QUANTTOTALEXP)               IS NULL ,0, Sum(CONTRATOTRANSPORTE2.QUANTTOTALEXP)              ) AS QUANTTOTALEXP,
  IIF( Sum(CONTRATOTRANSPORTE2.VALORTOTALEXP)               IS NULL ,0, Sum(CONTRATOTRANSPORTE2.VALORTOTALEXP)              ) AS VALORTOTALEXP,
  IIF( Sum(CONTRATOTRANSPORTE2.QUANTADEPENDENTE)            IS NULL ,0, Sum(CONTRATOTRANSPORTE2.QUANTADEPENDENTE)           ) AS QUANTADEPENDENTE,
  IIF( Sum(CONTRATOTRANSPORTE2.VALORTOTALPENDENTE)          IS NULL ,0, Sum(CONTRATOTRANSPORTE2.VALORTOTALPENDENTE)         ) AS VALORTOTALPENDENTE,
  IIF( Sum(CONTRATOTRANSPORTE2.ValorTotalComissaoExecutado) IS NULL ,0, Sum(CONTRATOTRANSPORTE2.ValorTotalComissaoExecutado)) AS ValorTotalComissaoExecutado ,
  IIF( Sum(CONTRATOTRANSPORTE2.VlTotalComissaoPendente)     IS NULL ,0, Sum(CONTRATOTRANSPORTE2.VlTotalComissaoPendente)    ) AS VlTotalComissaoPendente ,
  IIF( Sum(CONTRATOTRANSPORTE2.VALORTOTALCOMISSAO)          IS NULL ,0, Sum(CONTRATOTRANSPORTE2.VALORTOTALCOMISSAO)         ) AS VALORTOTALCOMISSAO



SELECT
  CONTRATOTRANSPORTE.NOMEMIX                            as NOMEMIX ,
  PRODUTOs.QUANT_PREVISTA                               as QUANT_PREVISTA ,
  PRODUTOs.VALOR_PREVISTO                               as VALOR_PREVISTO ,
  /* IIF( (CONTRATOTRANSPORTE.QUANTIDADETOTAL) 	        IS NULL ,0, (CONTRATOTRANSPORTE.QUANTIDADETOTAL) 	         ) AS QuantidadeTotal, */
  (select iif(sum( ProdutoContratoT.Quantidade)IS NULL ,0,sum( ProdutoContratoT.Quantidade) )  from ProdutoContratoT where  CONTRATOTRANSPORTE.Contrato =  ProdutoContratoT.Contrato )   QuantidadeTotal,
  /* iIF( (CONTRATOTRANSPORTE.VALORSCCTOTAL)   	        IS NULL ,0, (CONTRATOTRANSPORTE.VALORSCCTOTAL)   	         )  AS VALORSCCTOTAL , */
  (select iif(sum( ProdutoContratoT.ValorSCC)IS NULL ,0,sum( ProdutoContratoT.ValorSCC) )  from ProdutoContratoT where  CONTRATOTRANSPORTE.Contrato =  ProdutoContratoT.Contrato )   VALORSCCTOTAL_pro,
  /* IIF( (CONTRATOTRANSPORTE.QUANTTOTALEXP )   	        IS NULL ,0, (CONTRATOTRANSPORTE.QUANTTOTALEXP)   	         )  AS QUANTTOTALEXP, */
  (select iif(sum( ExportadoTransito.QuantidadeExp)IS NULL ,0,sum( ExportadoTransito.QuantidadeExp) )  from ExportadoTransito where  CONTRATOTRANSPORTE.Contrato =  ExportadoTransito.Contrato )   QUANTTOTALEXP_pro,
  /* IIF( (CONTRATOTRANSPORTE.VALORTOTALEXP)   	        IS NULL ,0, (CONTRATOTRANSPORTE.VALORTOTALEXP)   	         )  AS VALORTOTALEXP, */
  (select iif(sum( ExportadoTransito.VALOR) IS NULL ,0,sum( ExportadoTransito.VALOR) )  from ExportadoTransito where  CONTRATOTRANSPORTE.Contrato =  ExportadoTransito.Contrato )   VALORTOTALEXP_pro,
  IIF( (CONTRATOTRANSPORTE.QUANTADEPENDENTE)            IS NULL ,0, (CONTRATOTRANSPORTE.QUANTADEPENDENTE)           )  AS QUANTADEPENDENTE,
  IIF( (CONTRATOTRANSPORTE.VALORTOTALPENDENTE)          IS NULL ,0, (CONTRATOTRANSPORTE.VALORTOTALPENDENTE)         )  AS VALORTOTALPENDENTE,
  IIF( (CONTRATOTRANSPORTE.ValorTotalComissaoExecutado) IS NULL ,0, (CONTRATOTRANSPORTE.ValorTotalComissaoExecutado))  AS ValorTotalComissaoExecutado ,
  (select iif(sum( ExportadoTransito.ValorConvertido)IS NULL ,0,sum( ExportadoTransito.ValorConvertido) )  from ExportadoTransito where  CONTRATOTRANSPORTE.Contrato =  ExportadoTransito.Contrato )   ValorTotalComissaoExecutado_pro,
  IIF( (CONTRATOTRANSPORTE.VlTotalComissaoPendente)     IS NULL ,0, (CONTRATOTRANSPORTE.VlTotalComissaoPendente)    )  AS VlTotalComissaoPendente ,
  IIF( (CONTRATOTRANSPORTE.VlTotalComissaoPendente)     IS NULL ,0, (CONTRATOTRANSPORTE.VlTotalComissaoPendente)    )  AS VlTotalComissaoPendente_PRO ,  
/* VlTotalComissaoPendente := TabGlobal.DContratoTransporte.ValorTotalComissao.Conteudo - TabGlobal.DContratoTransporte.ValorTotalComissaoExecutado.Conteudo ;*/
  (select iif(sum( ProdutoContratoT.ComisaoSFatura)IS NULL ,0,sum( ProdutoContratoT.ComisaoSFatura) )  from ProdutoContratoT where  CONTRATOTRANSPORTE.Contrato =  ProdutoContratoT.Contrato )   VALORTOTALCOMISSAO_pro,
  ( VALORTOTALCOMISSAO_pro - ValorTotalComissaoExecutado_pro )
  IIF( (CONTRATOTRANSPORTE.VALORTOTALCOMISSAO)          IS NULL ,0, (CONTRATOTRANSPORTE.VALORTOTALCOMISSAO)         )  AS VALORTOTALCOMISSAO
FROM CONTRATOTRANSPORTE ,  PRODUTOS  where CONTRATOTRANSPORTE.NOMEMIX = PRODUTOs.PRODUTO AND  CONTRATOTRANSPORTE.CADASTRO >= '2012/12/01' AND CONTRATOTRANSPORTE.CADASTRO <= '2013/08/15'
/* GROUP BY CONTRATOTRANSPORTE.NOMEMIX     ,PRODUTOs.QUANT_PREVISTA, PRODUTOs.VALOR_PREVISTO

   (select sum( ProdutoContratoT.Quantidade)   from ProdutoContratoT where  CONTRATOTRANSPORTE.Contrato =  ProdutoContratoT.Contrato )   QuantidadeTotal_pro, */